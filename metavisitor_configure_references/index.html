<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Prepare Metavisitor Galaxy instance for analyses - Metavisitor-2</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Prepare Metavisitor Galaxy instance for analyses";
    var mkdocs_page_input_path = "metavisitor_configure_references.md";
    var mkdocs_page_url = "/metavisitor/metavisitor_configure_references/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Metavisitor-2</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Metavisitor</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Prepare Metavisitor Galaxy instance for analyses</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#1-connect-to-your-metavisitor-galaxy-admin-account-with-your-web-browser">1. Connect to your Metavisitor Galaxy admin account with your web browser</a></li>
    

    <li class="toctree-l2"><a href="#2-import-reference-data-in-an-history-references">2. Import reference data in an history "References"</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#a-preliminary-actions">a. Preliminary actions</a></li>
        
            <li><a class="toctree-l3" href="#b-upload-nucleotide-vir2-fasta-file">b. Upload nucleotide vir2 fasta file</a></li>
        
        </ul>
    

    <li class="toctree-l2"><a href="#3-prepare-blast-databases">3. Prepare Blast databases</a></li>
    

    <li class="toctree-l2"><a href="#4-creating-galaxy-dbkey-and-fasta-references-accessible-to-tools-for-every-user">4. Creating Galaxy dbkey and fasta references accessible to tools for every user</a></li>
    

    <li class="toctree-l2"><a href="#5-creating-galaxy-bowtie-indexes-accessible-to-tools-for-every-user">5. Creating Galaxy bowtie indexes accessible to tools for every user</a></li>
    

    <li class="toctree-l2"><a href="#6-creating-galaxy-bowtie2-indexes-accessible-to-tools-for-every-user">6. Creating Galaxy bowtie2 indexes accessible to tools for every user</a></li>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../use_cases_input_data/">Prepare input data histories</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../use_case_1/">Use Cases 1-1 to 1-4</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../use_case_2/">Use Cases 2-1 and 2-2</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../use_case_3-1/">Use Case 3-1</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../use_case_3-2/">Use Case 3-2</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../use_case_3-3/">Use Case 3-3</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Install_Metavisitor</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../install_metavisitor/">Intro</a>
                </li>
                <li class="">
                    
    <a class="" href="../metavisitor_ansible/">GalaxyKickStart</a>
                </li>
                <li class="">
                    
    <a class="" href="../metavisitor_docker/">Docker</a>
                </li>
                <li class="">
                    
    <a class="" href="../metavisitor_access_control/">Access and Control Metavisitor Galaxy instance</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Metavisitor-2</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Prepare Metavisitor Galaxy instance for analyses</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/ARTbio/metavisitor/edit/master/docs/metavisitor_configure_references.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>Once you know how to access to your Metavisitor Galaxy instance with a web browser and
are able to perform basic start/stop/restart operations, there is still some work needed
to import and configure reference data (reference genomes and databases) so that they are
directly available to all Galaxy users for running tools and workflows.</p>
<p>Here we provide the step-by-step description of what we did to prepare our Metavisitor
instance before performing the analyses described <a href="http://dx.doi.org/10.1101/048983">here</a>.</p>
<h2 id="1-connect-to-your-metavisitor-galaxy-admin-account-with-your-web-browser">1. Connect to your Metavisitor Galaxy admin account with your web browser</h2>
<h2 id="2-import-reference-data-in-an-history-references">2. Import reference data in an history "References"</h2>
<p>At first, you need to import and prepare the reference datasets you will need for most of
the Metavisitor analyses. As a Galaxy admin you will make latter some of these references
directly accessible to the Galaxy tools, and/or accessible to any other users by putting
them in a Galaxy public library.</p>
<h4 id="a-preliminary-actions">a. Preliminary actions</h4>
<ul>
<li>Click on the <code>Analyze Data</code> menu</li>
<li>rename the <code>Unnamed history</code> to <code>References</code></li>
</ul>
<h4 id="b-upload-nucleotide-vir2-fasta-file">b. Upload nucleotide vir2 fasta file</h4>
<ul>
<li>Click on the <img alt="upload_button" src="../images/upload_button.png" /> button on top of the tool bar (left handside of the Galaxy interface)</li>
<li>In the open window, click on the <code>Rule-based</code> tab <img alt="rule-based" src="../images/rule_based_tab.png" /></li>
<li>Make sure "Upload data as:" is set to datasets and "Load tabular data from:" is set to Pasted Table</li>
<li>Copy - paste the following table (not including the header)</li>
</ul>
<table>
<thead>
<tr>
<th>Name</th>
<th>URL</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>nucleotide vir2</code></td>
<td>https://ndownloader.figshare.com/files/11005121</td>
</tr>
<tr>
<td><code>protein vir2</code></td>
<td>https://ndownloader.figshare.com/files/11005124</td>
</tr>
<tr>
<td><code>dm6</code></td>
<td>ftp://ftp.flybase.net/genomes/Drosophila_melanogaster/dmel_r6.10_FB2016_02/fasta/dmel-all-chromosome-r6.10.fasta.gz</td>
</tr>
<tr>
<td><code>AgamP4</code></td>
<td>https://www.vectorbase.org/sites/default/files/ftp/downloads/Anopheles-gambiae-PEST_CHROMOSOMES_AgamP4.fa.gz</td>
</tr>
<tr>
<td><code>P. berghei</code></td>
<td>ftp://ftp.ensemblgenomes.org/pub/release-28/protists/fasta/plasmodium_berghei/dna/Plasmodium_berghei.May_2010.28.dna_sm.genome.fa.gz</td>
</tr>
<tr>
<td><code>hg38</code></td>
<td>ftp://ftp.ensembl.org/pub/release-84/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz</td>
</tr>
</tbody>
</table>
<ul>
<li>Click on the <code>Build</code> button on the bottom right</li>
<li>Click on the <code>+ Rules</code> button on the bottom left <img alt="rules" src="../images/rules.png" /></li>
<li>Select <code>Add / Modify Column Definitions</code> from the list</li>
<li>Click the <code>+ Add Definition</code> button, then select <code>Name</code> from the list and set column "A" as Name column</li>
<li>Click the <code>+ Add Definition</code> button, select <code>URL</code> and set the "B" column as URL column</li>
<li>Click the <code>Apply</code> button. Finally click the <code>Upload</code> button in the bottom right</li>
</ul>
<p>The reference genomes should be uploaded shortly to Galaxy.</p>
<h2 id="3-prepare-blast-databases">3. Prepare Blast databases</h2>
<ul>
<li>Use the tool <code>NCBI BLAST+ makeblastdb</code></li>
</ul>
<table>
<thead>
<tr>
<th>What to set in each form field for</th>
<th>nucleotide vir2</th>
<th>protein vir2</th>
</tr>
</thead>
<tbody>
<tr>
<td>Molecule type of input</td>
<td>nucleotide</td>
<td>protein</td>
</tr>
<tr>
<td>Input FASTA files(s)</td>
<td>dataset 1 (nucleotide vir2)</td>
<td>dataset 2 (protein vir2)</td>
</tr>
<tr>
<td>Title for BLAST database</td>
<td>nucleotide vir2 blastdb</td>
<td>protein vir2 blastdb</td>
</tr>
</tbody>
</table>
<ul>
<li>Leave the rest of the form unchanged and click the <code>Execute</code> button</li>
<li>Rename the generated datasets "<em>nucleotide vir2 blast database</em>" and "<em>protein vir2 blast database</em>" for clarity</li>
</ul>
<h2 id="4-creating-galaxy-dbkey-and-fasta-references-accessible-to-tools-for-every-user">4. Creating Galaxy dbkey and fasta references accessible to tools for every user</h2>
<p>Be sure that the <code>References</code> history is selected in the background, otherwise the uploaded genomes will not be available.</p>
<ul>
<li>Go to the <code>admin</code> panel</li>
<li>Click <code>Local data</code> in the left menu</li>
<li>Select the <code>Create DBKey and Reference Genome</code> in the "<strong>Data Managers</strong>" table</li>
</ul>
<table>
<thead>
<tr>
<th>What to set in each form field for</th>
<th>nucleotide vir2</th>
<th>dm6</th>
<th>AgamP4</th>
<th>hg38</th>
</tr>
</thead>
<tbody>
<tr>
<td>Use existing dbkey or create a new one</td>
<td>New</td>
<td>New</td>
<td>New</td>
<td>New</td>
</tr>
<tr>
<td>dbkey</td>
<td>vir2</td>
<td>dm6</td>
<td>AgamP4</td>
<td>hg38</td>
</tr>
<tr>
<td>Choose the source for the reference genome</td>
<td>History</td>
<td>History</td>
<td>History</td>
<td>History</td>
</tr>
<tr>
<td>FASTA file</td>
<td>nucleotide vir2</td>
<td>dm6</td>
<td>AgamP4</td>
<td>hg38</td>
</tr>
</tbody>
</table>
<ul>
<li>Leave the rest of the fields empty and click the <code>Execute</code> button</li>
</ul>
<p><strong>Tip:</strong> <em>Once you have run the first job. You can expand the new dataset that appeared in
your history and click on the</em> <img alt="redo" src="../images/redo.png" /> <em>button, instead of going back to
the admin panel.</em></p>
<h2 id="5-creating-galaxy-bowtie-indexes-accessible-to-tools-for-every-user">5. Creating Galaxy bowtie indexes accessible to tools for every user</h2>
<p>Now we are going to generate the bowtie indexes using another data manager tool.</p>
<ul>
<li>Go to the <code>admin</code> panel</li>
<li>Click <code>Local data</code> in the left menu</li>
<li>Select the <code>Bowtie index builder</code> in the "<strong>Data Managers</strong>" table</li>
<li>Select "<em>vir2</em>" in the "Source FASTA Sequence"</li>
<li>Leave the other options empty and click the <code>Execute</code> button</li>
<li>Expand the "<em>bowtie index</em>" dataset that appeared in your history and click the <img alt="redo" src="../images/redo.png" /> button</li>
<li>Repeat the previous 3 steps for "<em>dm6</em>", "<em>AgamP4</em>" and "<em>hg19</em>"</li>
</ul>
<hr />
<p><strong>Note that the preparation of bowtie indexes can be long (several hours for the vir2 bowtie index for instance)</strong></p>
<h2 id="6-creating-galaxy-bowtie2-indexes-accessible-to-tools-for-every-user">6. Creating Galaxy bowtie2 indexes accessible to tools for every user</h2>
<p>Finally, we are going to generate the bowtie2 indexes using another data manager tool.</p>
<ul>
<li>Go to the <code>admin</code> panel</li>
<li>Click <code>Local data</code> in the left menu</li>
<li>Select the <code>Bowtie2 index builder</code> in the "<strong>Data Managers</strong>" table</li>
<li>Select "<em>vir2</em>" in the "Source FASTA Sequence"</li>
<li>Leave the other options empty and click the <code>Execute</code> button</li>
<li>Expand the "<em>bowtie index</em>" dataset that appeared in your history and click the <img alt="redo" src="../images/redo.png" /> button</li>
<li>Repeat the previous 3 steps for "<em>AgamP4</em>" and "<em>hg19</em>"</li>
</ul>
<hr />
<p><strong>Note that the preparation of bowtie2 indexes can be long too (several hours for the vir2 bowtie2 index for instance)</strong></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../use_cases_input_data/" class="btn btn-neutral float-right" title="Prepare input data histories">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href=".." class="btn btn-neutral" title="Metavisitor"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/ARTbio/metavisitor/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../use_cases_input_data/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
